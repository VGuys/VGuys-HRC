<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>V Guys Health Risk Calculator</title>
</head>
<body>
    <h2>V Guys Health Risk Calculator</h2>

    <form id="healthForm">
        <label>Age: <input type="number" name="age" required></label><br><br>
        <label>Height (cm): <input type="number" name="height" required></label><br><br>
        <label>Weight (kg): <input type="number" name="weight" required></label><br><br>
        <label>Systolic BP: <input type="number" name="systolic" required></label><br><br>
        <label>Diastolic BP: <input type="number" name="diastolic" required></label><br><br>

        <fieldset>
            <legend>Family Diseases (check all that apply):</legend>
            <label><input type="checkbox" name="familyDiseases" value="diabetes"> Diabetes</label><br>
            <label><input type="checkbox" name="familyDiseases" value="cancer"> Cancer</label><br>
            <label><input type="checkbox" name="familyDiseases" value="Alzheimer’s"> Alzheimer’s</label><br>
        </fieldset><br>

        <button type="submit">Calculate Risk</button>
    </form>

    <h3 id="result"></h3>

    <script>
        document.getElementById('healthForm').addEventListener('submit', async function(event) {
            event.preventDefault();

            const form = event.target;
            const formData = new FormData(form);

            const data = {
                age: parseInt(formData.get('age')),
                height: parseFloat(formData.get('height')),
                weight: parseFloat(formData.get('weight')),
                systolic: parseInt(formData.get('systolic')),
                diastolic: parseInt(formData.get('diastolic')),
                familyDiseases: formData.getAll('familyDiseases')
            };

            try {
                const res = await fetch('/health-risk', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                const result = await res.json();
                document.getElementById('result').innerText = 
                    `Risk Score: ${result.riskScore} | BMI: ${result.bmi} | Risk Category: ${result.riskCategory}`;
            } catch (error) {
                document.getElementById('result').innerText = "Error calculating risk.";
                console.error(error);
            }
        });
    </script>
</body>
</html>
