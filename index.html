<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>V Guys Health Risk Calculator</title>
</head>
<body>
    <h2>Health Risk Calculator</h2>
    <form id="riskForm">
        Age: <input type="number" name="age" required min="1"><br>
        
        Height (cm): <input type="number" name="height" required min="1"><br>
        Weight (kg): <input type="number" name="weight" required min="1"><br>

        Systolic Blood Pressure (optional): <input type="number" name="systolic" min="1"><br>
        Diastolic Blood Pressure (optional): <input type="number" name="diastolic" min="1"><br>

        Family Disease History (Select all that apply):<br>
        <label><input type="checkbox" name="familyHistory" value="diabetes"> Diabetes</label><br>
        <label><input type="checkbox" name="familyHistory" value="cancer"> Cancer</label><br>
        <label><input type="checkbox" name="familyHistory" value="heart disease"> Heart Disease</label><br><br>

        <button type="submit">Calculate Risk</button>
    </form>

    <p id="result"></p>

    <script>
        const apiUrl = "https://vguys-hrc-cwc0cpe8fgf9bvdd.uaenorth-01.azurewebsites.net/api/calculate-risk";

        document.getElementById("riskForm").addEventListener("submit", async function (e) {
            e.preventDefault();

            const form = e.target;
            const familyHistory = [];
            document.querySelectorAll('input[name="familyHistory"]:checked').forEach(checkbox => {
                familyHistory.push(checkbox.value);
            });

            const data = {
                age: parseInt(form.age.value),
                height: parseFloat(form.height.value),
                weight: parseFloat(form.weight.value),
                systolic: form.systolic.value ? parseInt(form.systolic.value) : null,
                diastolic: form.diastolic.value ? parseInt(form.diastolic.value) : null,
                familyHistory: familyHistory
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                document.getElementById("result").innerText = `Health Risk: ${result.riskCategory}, BMI: ${result.bmi}, Score: ${result.riskScore}`;
            } catch (error) {
                document.getElementById("result").innerText = "Error: " + error.message;
            }
        });
    </script>
</body>
</html>
